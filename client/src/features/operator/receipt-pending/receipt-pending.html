<div class="min-h-screen bg-base-100 text-base-content flex flex-col items-center py-10 px-4 mt-10">
  <div class="w-full max-w-5xl bg-white shadow-md rounded-2xl p-6">
    <h2 class="text-2xl font-bold mb-5 flex items-center gap-2">
      üßæ Danh s√°ch h√≥a ƒë∆°n ch·ªù x√°c nh·∫≠n
    </h2>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center py-6 text-secondary text-lg">
      <span class="loading loading-spinner loading-md me-2"></span>
      ƒêang t·∫£i d·ªØ li·ªáu...
    </div>

    <!-- Danh s√°ch h√≥a ƒë∆°n -->
    <div *ngIf="!loading && receipts.length > 0" class="overflow-x-auto">
      <table class="table table-zebra w-full text-center">
        <thead class="bg-base-200 text-base font-semibold">
          <tr>
            <th>ID</th>
            <th>Kh√°ch h√†ng</th>
            <th>G√≥i c∆∞·ªõc</th>
            <th>T·ªïng ti·ªÅn</th>
            <th>Ng√†y t·∫°o</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let r of receipts"
            class="hover:bg-base-200 transition duration-150 ease-in-out"
          >
            <td class="font-semibold">#{{ r.id }}</td>
            <td>{{ r.appUserName || '‚Äî' }}</td>
            <td>{{ r.pricingName }}</td>
            <td class="text-success font-medium">{{ r.totalCost | number }} ‚Ç´</td>
            <td>{{ r.createAt | date : 'short' }}</td>
            <td>
              <button
                class="btn btn-sm btn-primary"
                (click)="viewDetails(r.id)"
              >
                Xem chi ti·∫øt
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Kh√¥ng c√≥ d·ªØ li·ªáu -->
    <div *ngIf="!loading && receipts.length === 0" class="text-center py-8 text-gray-500">
      üö´ Kh√¥ng c√≥ h√≥a ƒë∆°n n√†o ƒëang ch·ªù x√°c nh·∫≠n.
    </div>

    <!-- Chi ti·∫øt h√≥a ƒë∆°n -->
    <div
      *ngIf="showDetails && selectedReceipt"
      class="mt-8 border-t border-gray-300 pt-5"
    >
      <h3 class="text-xl font-semibold mb-4">
        üßæ Chi ti·∫øt h√≥a ƒë∆°n #{{ selectedReceipt.id }}
      </h3>

      <div class="grid md:grid-cols-2 gap-3 mb-4">
        <div><b>Kh√°ch h√†ng:</b> {{ selectedReceipt.appUserName }}</div>
        <div><b>G√≥i c∆∞·ªõc:</b> {{ selectedReceipt.pricingName }}</div>
        <div><b>T·ªïng ti·ªÅn:</b> {{ selectedReceipt.totalCost | number }} ‚Ç´</div>
        <div><b>Ng√†y t·∫°o:</b> {{ selectedReceipt.createAt | date : 'short' }}</div>
        <div><b>Tr·∫°ng th√°i:</b> {{ selectedReceipt.status }}</div>
      </div>

      <div class="mb-4">
        <label for="paymentMethod" class="block font-medium mb-1"
          >Ph∆∞∆°ng th·ª©c thanh to√°n:</label
        >
        <select
          id="paymentMethod"
          [(ngModel)]="paymentMethod"
          class="select select-bordered w-full max-w-xs"
        >
          <option *ngFor="let method of paymentMethods" [value]="method">
            {{ method }}
          </option>
        </select>
      </div>

      <!-- Alert n·∫øu c√≥ l·ªói ho·∫∑c th√¥ng b√°o -->
      <div *ngIf="alertMessage" class="alert mt-3" [ngClass]="{
          'alert-success': alertType === 'success',
          'alert-error': alertType === 'error'
        }">
        {{ alertMessage }}
      </div>

      <!-- N√∫t h√†nh ƒë·ªông -->
      <div class="mt-5 flex flex-wrap gap-3">
        <button
          class="btn btn-success"
          (click)="confirmPayment()"
          [disabled]="confirming"
        >
          <span *ngIf="!confirming">‚úÖ X√°c nh·∫≠n thanh to√°n</span>
          <span *ngIf="confirming" class="loading loading-spinner"></span>
          <span *ngIf="confirming"> ƒêang x·ª≠ l√Ω...</span>
        </button>

        <button
          class="btn btn-outline btn-secondary"
          (click)="showDetails = false"
        >
          ‚ùå ƒê√≥ng
        </button>
      </div>
    </div>
  </div>
</div>
