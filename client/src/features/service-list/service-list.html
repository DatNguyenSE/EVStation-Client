<div class="w-full min-h-screen font-sans antialiased relative ">
  <div class="absolute inset-0 bg-cover bg-center"
    style="background-image: url('/assets/background/nen-tram-sac-xe-dien.png'); filter: brightness(0.55) blur(2px);">
  </div>

  <div class="relative z-10">
    <header class="flex justify-between items-center px-6 py-4 bg-blue-900 text-white shadow-xl sticky top-0 z-20">
      <h1 class="text-3xl font-extrabold tracking-wider">
        evStation | Dịch vụ Sạc
      </h1>
    </header>

    <div class="py-6 px-6 ">
      <div class="grid grid-cols-2 sm:grid-cols-5 gap-4 max-w-5xl mx-auto">
        <button class="p-4 rounded-xl shadow-md border transition-all duration-300 flex flex-col items-center justify-center
                 hover:shadow-lg hover:-translate-y-1
                 select-none" [ngClass]="{
            'bg-blue-600 text-white border-blue-600': activeTab === 'register-vehicle',
            'bg-base-100 text-base-content  border-base-300': activeTab !== 'register-vehicle'
          }" (click)="activeTab = 'register-vehicle'">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
            class="size-8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M12 9.75v6.75m0 0-3-3m3 3 3-3m-8.25 6a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z" />
          </svg>

          <span class="font-semibold text-sm">Đăng kí xe</span>
        </button>

        <button class="p-4 rounded-xl shadow-md border transition-all duration-300 flex flex-col items-center justify-center
                 hover:shadow-lg hover:-translate-y-1
                 select-none" [ngClass]="{
            'bg-blue-600 text-white border-blue-600': activeTab === 'history',
            'bg-base-100 text-base-content  border-base-300': activeTab !== 'history'
          }" (click)="activeTab = 'history'">
          <svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-9-9 9 9 0 019 9z"></path>
          </svg>
          <span class="font-semibold text-sm">Lịch sử sạc</span>
        </button>

        <button class="p-4 rounded-xl shadow-md border transition-all duration-300 flex flex-col items-center justify-center
                 hover:shadow-lg hover:-translate-y-1
                 select-none" [ngClass]="{
            'bg-blue-600 text-white border-blue-600': activeTab === 'package',
            'bg-base-100 text-base-content  border-base-300': activeTab !== 'package'
          }" (click)="activeTab = 'package'">
          <svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
          </svg>
          <span class="font-semibold text-sm">Gói dịch vụ</span>
        </button>

        <button class="p-4 rounded-xl shadow-md border transition-all duration-300 flex flex-col items-center justify-center
                 hover:shadow-lg hover:-translate-y-1
                 select-none" [ngClass]="{
            'bg-blue-600 text-white border-blue-600': activeTab === 'qr',
            'bg-base-100 text-base-content  border-base-300': activeTab !== 'qr'
          }" (click)="activeTab = 'qr'">
          <svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z">
            </path>
          </svg>
          <span class="font-semibold text-sm">Quét QR</span>
        </button>

        <button class="p-4 rounded-xl shadow-md border transition-all duration-300 flex flex-col items-center justify-center
                 hover:shadow-lg hover:-translate-y-1
                 select-none" [ngClass]="{
            'bg-blue-600 text-white border-blue-600': activeTab === 'find',
            'bg-base-100 text-base-content border-base-300': activeTab !== 'find'
          }" (click)="activeTab = 'find'">
          <svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
          <span class="font-semibold text-sm">Tìm Trạm Sạc</span>
        </button>
      </div>
    </div>
    <div class="p-4 md:p-8 max-w-6xl mx-auto">

      <div *ngIf="activeTab==='history'">
        <h2 class="text-xl font-semibold text-white mb-5 border-b pb-2 ">Hoạt động sạc gần đây</h2>
        <div class="bg-base-100 text-base-content rounded-xl shadow-xl p-6">
          <div class="flex flex-col space-y-4">
            <div
              *ngIf="isLoadingHistory"
              class="flex flex-col items-center justify-center py-10 text-gray-500"
            >
              <span class="loading loading-spinner loading-md text-blue-500 mb-3"></span>
              <p>Đang tải dữ liệu...</p>
            </div>
  
            <div
              *ngIf="!isLoadingHistory && paginatedHistory.length === 0"
              class="flex flex-col items-center justify-center py-10 text-gray-400 border border-dashed border-base-300 rounded-xl"
            >
              <i class="fa-regular fa-folder-open text-5xl mb-3"></i>
              <p class="font-medium">Bạn chưa có lịch sử sạc nào.</p>
              <p class="text-sm opacity-70">Các phiên sạc sẽ hiển thị tại đây.</p>
            </div>
  
            <div *ngIf="!isLoadingHistory && paginatedHistory.length > 0">
              <div class="overflow-x-auto rounded-xl border border-base-200">
                <table class="table table-zebra w-full">
                  <thead class="bg-base-200">
                    <tr class="text-base-content">
                      <th class="py-3 px-4 font-semibold">Ngày sạc</th>
                      <th class="py-3 px-4 font-semibold">Trạm sạc (Trụ)</th>
                      <th class="py-3 px-4 font-semibold">Năng lượng</th>
                      <th class="py-3 px-4 font-semibold">Trạng thái</th>
                      <th class="py-3 px-4 font-semibold text-right">Tổng tiền</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let item of paginatedHistory"
                      (click)="viewSessionDetail(item.id)"
                      class="hover:bg-blue-50 transition-all duration-150 cursor-pointer"
                    >
                      <td class="py-3 px-4">
                        <div class="font-medium">
                          {{ item.startTime | date : 'dd/MM/yy' }}
                        </div>
                        <div class="text-xs opacity-70">
                          {{ item.startTime | date : 'HH:mm' }}
                        </div>
                      </td>
                      <td class="py-3 px-4">
                        <div class="font-medium text-blue-700">
                          {{ item.stationName }}
                        </div>
                        <div class="text-xs opacity-70">
                          {{ item.chargingPostCode }}
                        </div>
                      </td>
                      <td class="py-3 px-4">{{ item.energyConsumed | number : '1.1-2' }} kWh</td>
                      <td class="py-3 px-4">
                        <span
                          class="badge badge-outline font-semibold"
                          [ngClass]="{
                            'badge-success text-success-content bg-green-100 border-green-300':
                              item.status === 'Completed' || item.status === 'Full',
                            'badge-error text-error-content bg-red-100 border-red-300':
                              item.status === 'Error',
                            'badge-warning text-warning-content bg-yellow-100 border-yellow-300':
                              item.status === 'StoppedDueToInsufficientFunds',
                            'badge-info text-info-content bg-blue-100 border-blue-300':
                              item.status === 'Charging',
                            'badge-ghost text-gray-600 border-gray-300': item.status === 'Idle'
                          }"
                        >
                          <span>{{ item.status }}</span>
                        </span>
                      </td>
                      <td class="py-3 px-4 text-right font-semibold text-green-700 text-base">
                        {{ item.totalCost | number }} ₫
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
  
              <div *ngIf="totalPages > 1" class="flex justify-center mt-6 pt-4">
                <div class="flex items-center gap-3 bg-base-200 p-2 rounded-full shadow-md">
                  <button
                    class="btn btn-sm btn-circle bg-base-100 hover:bg-blue-500 hover:text-white transition-all"
                    (click)="prevPage()"
                    [disabled]="!hasPreviousPage"
                  >
                    <i class="fa-solid fa-chevron-left"></i>
                  </button>
                  <span class="text-sm font-semibold text-blue-600">
                    Trang {{ currentPage }} / {{ totalPages }}
                  </span>
                  <button
                    class="btn btn-sm btn-circle bg-base-100 hover:bg-blue-500 hover:text-white transition-all"
                    (click)="nextPage()"
                    [disabled]="!hasNextPage"
                  >
                    <i class="fa-solid fa-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="activeTab==='package'">
        <h2 class="text-xl font-semibold text-white mb-5 border-b pb-2">
          Chọn gói dịch vụ phù hợp
        </h2>
        <div class="max-w-6xl mx-auto">
          <app-packages></app-packages>
        </div>
      </div>
      <div *ngIf="activeTab==='qr'"
        class="flex flex-col items-center mt-9 bg-white rounded-xl shadow-2xl max-w-md mx-auto border border-gray-100">
        <app-qr-code />
      </div>
      <div *ngIf="activeTab==='find'">
        <app-gg-map></app-gg-map>
      </div>
      <div *ngIf="activeTab==='register-vehicle'">
        <app-register-vehicle></app-register-vehicle>
      </div>

    </div>
  </div>
</div>